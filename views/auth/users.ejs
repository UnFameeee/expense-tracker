<div class="container mt-4">
  <h1>User Management</h1>
  
  <% if (success) { %>
    <div class="alert alert-success" role="alert">
      <%= success %>
    </div>
  <% } %>
  
  <div class="card">
    <div class="card-header">
      <h5 class="mb-0">All Users</h5>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>ID</th>
              <th>Username</th>
              <th>Email</th>
              <th>Role</th>
              <th>Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% users.forEach(user => { %>
              <tr>
                <td><%= user.id %></td>
                <td><%= user.username %></td>
                <td><%= user.email %></td>
                <td>
                  <span class="badge <%= user.role === 'admin' ? 'bg-danger' : 'bg-primary' %>">
                    <%= user.role %>
                  </span>
                </td>
                <td><%= new Date(user.created_at).toLocaleDateString() %></td>
                <td>
                  <% if (user.id !== locals.user.id) { %>
                    <form action="/auth/users/<%= user.id %>/role" method="POST" class="d-inline">
                      <input type="hidden" name="role" value="<%= user.role === 'admin' ? 'user' : 'admin' %>">
                      <button type="submit" class="btn btn-sm <%= user.role === 'admin' ? 'btn-outline-primary' : 'btn-outline-danger' %>">
                        Make <%= user.role === 'admin' ? 'User' : 'Admin' %>
                      </button>
                    </form>
                  <% } else { %>
                    <span class="text-muted">Current User</span>
                  <% } %>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div> 